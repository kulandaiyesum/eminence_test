<div class="exam-container">
  <div class="controls">
    <div class="button" *ngFor="let item of questions; let i = index">
      <p
        (click)="changeQuestions(i)"
        [ngClass]="{ selected: i === currentQuestionIndex }"
      >
        {{ i + 1 }}
      </p>
    </div>
  </div>
  <div class="main">
    <div class="questions" #scrollQuestionContainer>
      <div class="questions-main">
        <h6>Item {{ currentQuestionIndex + 1 }} of {{ totalQuestions }}</h6>
        <p>
          {{ indexBasedQuestions?.title }}
        </p>
        <div class="options" *ngFor="let option of indexBasedQuestions?.options; let i = index">
          <mat-checkbox
            (change)="optionSelected($event, i, option)"

            [value]="option?.text"
            (click)="
              storeList(option, indexBasedQuestions._id, currentQuestionIndex)
            "
            [(ngModel)]="option.checked"
          >
          {{ generateAlphabetChar(i) + '. ' + option?.text }}</mat-checkbox
          ><br>
        </div>
      </div>
    </div>
    <div class="explanations" #scrollExplanationContainer>
      <div class="explanations-main" *ngIf="showExplanations">
        <mat-accordion>
          <mat-expansion-panel>
            <mat-expansion-panel-header>
              <mat-panel-title> View answer </mat-panel-title>
            </mat-expansion-panel-header>
            <div id="correct-news" *ngIf="correctNews">
              <b><mat-icon>check_circle_outline</mat-icon></b>
              <p>You selected right answer</p>
            </div>
            <div id="incorrect-news" *ngIf="incorrectNews">
              <b><mat-icon>cancel</mat-icon></b>
              <p>You selected wrong answer</p>
            </div>
            <div *ngFor="let option of indexBasedQuestions?.options">
              <p *ngIf="option.correctAnswer === 'true'">
                <b>Correct Answer : </b> {{ option?.text }}
              </p>
            </div>
          </mat-expansion-panel>
        </mat-accordion>
        <div
          class="explanation-paragraph"
          *ngFor="let option of indexBasedQuestions?.options"
        >
          <!-- <p *ngIf="option.correctAnswer === 'true'">
            <b>Explanation : </b> {{ option?.explanation }}
          </p> -->
          <mat-accordion>
            <mat-expansion-panel
              *ngIf="
                option?.explanation !== null &&
                option?.explanation !== undefined
              "
              id="explanation-panel"
            >
              <mat-expansion-panel-header>
                <mat-panel-title> Explanation </mat-panel-title>
              </mat-expansion-panel-header>
              <p *ngIf="option.correctAnswer === 'true'">
                <b>Explanation : </b> {{ option?.explanation }}
              </p>
            </mat-expansion-panel>
          </mat-accordion>
        </div>
      </div>
    </div>
    <div class="flag">
      <mat-checkbox
        class="example-margin"
        [(ngModel)]="flagChecked"
        (change)="flagChanges()"
        >Flag</mat-checkbox
      >
      <mat-expansion-panel>
        <mat-expansion-panel-header> </mat-expansion-panel-header>
        <div class="content">
          <mat-icon svgIcon="custom-icon"></mat-icon>
          <mat-icon (click)="openCalculatorPopup()">exposure</mat-icon>
          <mat-icon>assignment</mat-icon>
        </div>
      </mat-expansion-panel>
    </div>
  </div>
  <div class="bottom-controls">
    <div class="bottom-main">
      <button mat-button (click)="previous()" *ngIf="currentQuestionIndex > 0">
        Prev
      </button>
      <button
        mat-button
        (click)="next()"
        *ngIf="currentQuestionIndex < maximumQuestionLength"
      >
        Next
      </button>
      <button
        mat-button
        *ngIf="questions?.length == examArray?.length"
        (click)="showEndExamConfirmation()"
      >
        End
      </button>
    </div>
  </div>
</div>
