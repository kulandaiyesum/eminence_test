<div class="exam-container">
  <div id="exam-code">
    <h5 *ngIf="liveExamRoomCode">Private exam room</h5>
    <p *ngIf="liveExamRoomCode">Room code : {{ liveExamRoomCode }}</p>
  </div>
  <div class="controls">
    <div class="button" *ngFor="let item of questions; let i = index">
      <p
        (click)="changeQuestions(i)"
        [ngClass]="{ selected: i === currentQuestionIndex }"
      >
        {{ i + 1 }}
        <span
          [ngClass]="{ flag_icon: isflaggedQuestion(item?._id) }"
        ></span>
      </p>
    </div>
  </div>
  <div class="main">
    <div class="questions" #scrollQuestionContainer>
      <div class="questions-main">
        <h6>Item {{ currentQuestionIndex + 1 }} of {{ totalQuestions }}</h6>
        <p>
          {{ indexBasedQuestions?.title }}
        </p>
        <div
          class="options"
          *ngFor="let option of indexBasedQuestions?.options; let i = index"
        >
          <mat-checkbox
            (change)="optionSelected($event, i, option)"
            [value]="option?.text"
            (click)="
              storeList(option, indexBasedQuestions._id, currentQuestionIndex)
            "
            [(ngModel)]="option.checked"
          >
            {{ generateAlphabetChar(i) + ". " + option?.text }}</mat-checkbox
          ><br />
        </div>
      </div>
    </div>
    <div class="explanations" #scrollExplanationContainer>
      
      <div class="explanations-main" *ngIf="showExplanations">
        <mat-accordion>
          <mat-expansion-panel>
            <mat-expansion-panel-header>
              <mat-panel-title> View answer </mat-panel-title>
            </mat-expansion-panel-header>
            <div id="correct-news" *ngIf="correctNews">
              <b><mat-icon>check_circle_outline</mat-icon></b>
              <p>You selected right answer</p>
            </div>
            <div id="incorrect-news" *ngIf="incorrectNews">
              <b><mat-icon>cancel</mat-icon></b>
              <p>You selected wrong answer</p>
            </div>
            <div *ngFor="let option of indexBasedQuestions?.options">
              <p *ngIf="option.correctAnswer === 'true'">
                <b>Correct Answer : </b> {{ option?.text }}
              </p>
            </div>
          </mat-expansion-panel>
        </mat-accordion>

        <div
          class="explanation-paragraph"
          *ngFor="let option of indexBasedQuestions?.options"
        >
          <!-- <p *ngIf="option.correctAnswer === 'true'">
            <b>Explanation : </b> {{ option?.explanation }}
          </p> -->
          <mat-accordion>
            <mat-expansion-panel
              *ngIf="
                option?.explanation !== null &&
                option?.explanation !== undefined
              "
              id="explanation-panel"
            >
              <mat-expansion-panel-header>
                <mat-panel-title> Explanation </mat-panel-title>
              </mat-expansion-panel-header>
              <p *ngIf="option.correctAnswer === 'true'">
                <b>Explanation : </b> {{ option?.explanation }}
              </p>
            </mat-expansion-panel>
          </mat-accordion>
        </div>
      </div>
    </div>
    <div class="flag_section">
      <mat-checkbox
        class="example-margin"
        [(ngModel)]="flagChecked"
        (change)="flagChanges()"
        >Flag</mat-checkbox
      >
      <div class="exapnsion_div">
        <img
          src="../../../../assets/images/triangle_blue.png"
          alt="triangle_blue"
          (click)="setHeight = !setHeight"
        />
        <img
          [ngStyle]="setHeight ? { display: 'inline' } : { display: 'none' }"
          src="../../../../assets/images/lab.png"
          alt="lab"
          (click)="openDialog()"
        />
        <img
          [ngStyle]="setHeight ? { display: 'inline' } : { display: 'none' }"
          style="transform: translateX(2px)"
          src="../../../../assets/images/notes.png"
          alt="notes"
          (click)="openNotepadEditor()"
        />
        <img
          [ngStyle]="setHeight ? { display: 'inline' } : { display: 'none' }"
          src="../../../../assets/images/calculator.png"
          alt="calculator"
          (click)="openCalculatorPopup()"
        />
      </div>
    </div>
  </div>
  <div class="bottom-controls">
    <div class="bottom-main">
      <button mat-button (click)="previous()" *ngIf="currentQuestionIndex > 0">
        Prev
      </button>
      <button
        mat-button
        (click)="next()"
        *ngIf="!(questLength === currentQuestionIndex + 1)"
      >
        Next
      </button>
      <button
        mat-button
        *ngIf="questLength === currentQuestionIndex + 1"
        (click)="showEndExamConfirmation()"
      >
        End
      </button>
    </div>
  </div>
</div>
